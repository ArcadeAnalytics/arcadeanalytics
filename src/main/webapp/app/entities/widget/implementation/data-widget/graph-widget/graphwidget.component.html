<!--Widget Header-->
<div *ngIf="!minimizedView" class="row">
    <div class="col-md-6" style="height: 35px;">
        <h2 style="margin: 0px;">
            <span>{{widget.name}}</span>
        </h2>
    </div>
    <div class="col-md-6" style="height: 35px;">
        <div class="btn-group flex-btn-group-container" style="position: relative; top: 10%;">
            <a type="submit" [routerLink]="['/dashboard', widget['dashboardId']]" routerLinkActive="active"
                [routerLinkActiveOptions]="{exact: true}" (click)="checkSidebarStatusOnExit()">
                <span class="fa fa-2x fa-times"></span>
            </a>
        </div>
    </div>
</div>

<hr *ngIf="!minimizedView" style="margin-top: 5px;">

<div class="widget-table" [id]="'widget-container_' + widgetId">

    <div style="display: table-row">

        <!-- Main sidebar -->
        <div [id]="'widget-sidebar_' + widgetId" *ngIf="!minimizedView"
            class="sidebar sidebar-main sidebar-fixed sidebar-default widget-table-cell">
            <div id="sidebar-dynamic" class="sidebar-content cell-content-wrapper" [ngStyle]="{height: sidebarHeight}">
                <div class="sidebar-category sidebar-category-visible">
                    <div class="category-content no-padding">

                        <ul id="firstLevelMenu" class="navigation navigation-main navigation-accordion">

                            <!-- Main -->
                            <li id="graphElementMenu">
                                <a class="has-ul">
                                    <i class="fa fa-circle-o fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '18.7px'}"></i>
                                    <span id="graph_selection">Graph Element</span>
                                </a>
                                <ul id="graph_menu">
                                    <li *ngIf="!lastSelectedElement">
                                        <a>Select a vertex or an edge in the graph</a>
                                    </li>
                                    <ng-container *ngIf="lastSelectedElement">
                                        <vertex-menu #vertexMenuComponent *ngIf="getLastSelectedElementType() === 'v'"
                                            [element]="lastSelectedElement['data']"
                                            [styleClass]="classStyleOfLastSelectedElement"
                                            [nodeClassProperties]="dataSourceMetadata['nodesClasses'][lastSelectedElement['data']['class']]['properties']"
                                            (saveEmitter)="updateStyleClass()"
                                            (readyForHighlightEmitter)="highlightGraphElementMenu()"></vertex-menu>
                                        <edge-menu #edgeMenuComponent *ngIf="getLastSelectedElementType() === 'e'"
                                            [element]="lastSelectedElement['data']"
                                            [styleClass]="classStyleOfLastSelectedElement"
                                            [edgeClassProperties]="dataSourceMetadata['edgesClasses'][lastSelectedElement['data']['class']]['properties']"
                                            (saveEmitter)="updateStyleClass()"
                                            (readyForHighlightEmitter)="highlightGraphElementMenu()"></edge-menu>
                                    </ng-container>
                                </ul>
                            </li>
                            <li id="traverseMenu">
                                <a class="has-ul">
                                    <i class="fa fa-arrows-alt fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '18.7px'}"></i>
                                    <span>Traverse</span>
                                </a>
                                <ul>
                                    <li *ngIf="selectedNodesCardinality === 0">
                                        <a>Select at least one vertex in the graph</a>
                                    </li>
                                    <li *ngIf="selectedNodesCardinality > 0">
                                        <traverse-menu #traverseMenu [parentComponent]="instance"
                                            (inputNodesRequestEmitter)="updateTraverseMenu()"
                                            (traverseRequestEmitter)="executeTraverseFromEvent($event)">
                                        </traverse-menu>
                                    </li>
                                </ul>
                            </li>
                            <li id="searchMenu" [popover]="startingPopoverMessage" [isOpen]="startingPopoverMustBeOpen"
                                placement="right" container="body" (mouseover)="closePopover('startingPopover')"
                                triggers="">
                                <a>
                                    <i class="fa fa-search fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '16.84px'}"></i>
                                    <span>Search</span>
                                </a>
                                <ul>
                                    <li>
                                        <a (click)="openNodesFetchingModal(fetchNodesModal)">
                                            <i class="fa fa-cogs"></i>Fetch Nodes from Class
                                        </a>
                                    </li>
                                    <li>
                                        <a (click)="openQueryModal(queryModal)">
                                            <i class="fa fa-cogs"></i>Type Query
                                        </a>
                                    </li>
                                </ul>

                                <ng-template #fetchNodesModal>
                                    <div class="modal-header">
                                        <h4 class="modal-title" jhiTranslate="graphwidget.fetchNodesModal.title">Fetch
                                            Nodes</h4>
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                                            (click)="modalRef.hide()">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <div class="col-lg-6">
                                                <label for="nodeClassSelection">Node Class</label>
                                                <select *ngIf="dataSourceMetadata" id="nodeClassSelection"
                                                    class="form-control" [(ngModel)]="nodeClassForNodeFetching">
                                                    <option
                                                        *ngFor="let classesNames of (dataSourceMetadata.nodesClasses | objectKeys)"
                                                        [ngValue]="classesNames"> {{classesNames}} </option>
                                                </select>
                                                <select *ngIf="!dataSourceMetadata" id="nodeClassSelection"
                                                    class="form-control" disabled>
                                                </select>
                                            </div>
                                            <div class="col-lg-6">
                                                <label for="nodeClassSelection">Limit</label>
                                                <input id="limit" class="form-control" type="number" min="1" step="1"
                                                    [(ngModel)]="limitForNodeFetching">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer" style="padding-top: 40px;">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                            (click)="modalRef.hide()">
                                            <span class="fa fa-ban"></span>&nbsp;
                                            <span jhiTranslate="graphwidget.fetchNodesModal.cancel">Cancel</span>
                                        </button>
                                        <button type="button" class="btn btn-primary"
                                            (click)="loadElementsFromClasses()"
                                            [ngClass]="{'disabled': (!nodeClassForNodeFetching)}">
                                            <span jhiTranslate="graphwidget.fetchNodesModal.submit">Submit</span>
                                            <i class="icon-arrow-right14 position-right"></i>
                                        </button>
                                    </div>
                                </ng-template>

                                <ng-template #queryModal>
                                    <div class="modal-header">
                                        <h4 class="modal-title" jhiTranslate="graphwidget.queryModal.title">Query</h4>
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                                            (click)="modalRef.hide()">&times;</button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="form-group">
                                            <label>&nbsp;Execute a query against the datasource: </label>
                                            ​
                                            <textarea id="query" class="form-control" rows="5" cols="70"
                                                [(ngModel)]="currentQuery"
                                                placeholder="Type the query to execute..."></textarea>
                                        </div>
                                    </div>
                                    <div class="modal-footer" style="padding-top: 40px;">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                            (click)="modalRef.hide()">
                                            <span class="fa fa-ban"></span>&nbsp;
                                            <span jhiTranslate="graphwidget.queryModal.cancel">Cancel</span>
                                        </button>
                                        <button type="button" class="btn btn-primary"
                                            (click)="loadDataFromCurrentQuery()"
                                            [ngClass]="{'disabled': (!currentQuery || currentQuery.length === 0)}">
                                            <span jhiTranslate="graphwidget.queryModal.submit">Submit</span>
                                            <i class="icon-arrow-right14 position-right"></i>
                                        </button>
                                    </div>
                                </ng-template>

                            </li>
                            <li id="dynamicFilterMenu">
                                <a>
                                    <i *ngIf="sidebarCollapsed" class="fa fa-filter fa-2x">
                                        <span *ngIf="filters" class="badge bg-warning-400"
                                            style="font-size: 0.4em; z-index: 2; position: absolute; left: 33px;">{{filters.length}}</span>
                                    </i>
                                    <i *ngIf="!sidebarCollapsed" class="fa fa-filter fa-2x"
                                        style="margin-right: 20.56px;">
                                        <span *ngIf="filters" class="badge bg-warning-400"
                                            style="z-index: 2; position: absolute; left: 33px; top: 0px;">{{filters.length}}</span>
                                    </i>
                                    <span>Filter</span>
                                </a>
                                <ul id='filterMenu'>
                                    <li>
                                        <div *ngIf="dataSource && dataSource['indexing'] === 'INDEXED'">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <a id="filter_reset_all" class="btn btn-primary"
                                                        (click)="graphFilterResults()"
                                                        style="color: rgba(255,255,255,.75);">
                                                        Re-Apply Filters
                                                    </a>
                                                </div>
                                                <div class="col-md-6">
                                                    <a id="filter_reset_all" class="btn btn-danger"
                                                        (click)="filterResetAll()"
                                                        style="color: rgba(255,255,255,.75);">
                                                        Reset All Filters
                                                    </a>
                                                </div>
                                            </div>
                                            <div>
                                                <filter-menu #filterMenuComponent
                                                    [datasourceId]="widget['dataSourceId']" [startingFilters]="filters"
                                                    (filterResultsEmitter)="graphFilterResults($event)"
                                                    (facetsLoaded)="sidebarResetMenu()">
                                                </filter-menu>
                                            </div>
                                        </div>
                                        <div *ngIf="dataSource" class="row" style="padding: 5px 1px 0px 10px;">
                                            <div *ngIf="dataSource['indexing'] === 'NOT_INDEXED' || dataSource['indexing'] === undefined"
                                                class="col-md-12 btn-group">
                                                <span>
                                                    <b>Filter menu deactivated</b>
                                                    <br /> You need to index your source Database.</span>
                                                <br />
                                                <br />
                                                <button type="button" class="btn btn-sm btn-primary"
                                                    *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']"
                                                    (click)="callDatasourceIndexing()">
                                                    <i class="fa fa-refresh" aria-hidden="true"></i>
                                                    <span>Index Datasource</span>
                                                </button>
                                                <button type="button" class="btn btn-sm btn-primary"
                                                    *jhiHasAnyAuthority="['ROLE_READER']" disabled>
                                                    <i class="fa fa-refresh" aria-hidden="true"></i>
                                                    <span>Index Datasource</span>
                                                </button>
                                            </div>
                                        </div>
                                        <div *ngIf="dataSource" class="row" style="padding: 5px 1px 0px 10px;">
                                            <div *ngIf="dataSource['indexing'] === 'INDEXING'"
                                                class="col-md-12 btn-group">
                                                <span>
                                                    <b>Filter menu deactivated</b>
                                                    <br /> Source database is being indexed, please wait till the
                                                    process will
                                                    be completed.</span>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li id="selectionMenu">
                                <a>
                                    <i class="fa fa-hand-pointer-o fa-2x"></i>
                                    <span>Selection</span>
                                </a>
                                <ul>
                                    <li>
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-11 btn-group">
                                                <input id="searchInput" type="text" class="form-control"
                                                    placeholder="Type the text to search..." [(ngModel)]="inputSearch"
                                                    (keydown)="handleSearchOnKeydown($event)">
                                                <span id="searchClear" class="fa fa-times-circle-o"
                                                    (click)="inputSearch = undefined" title="Clear"></span>

                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <i class="fa fa-question-circle command" aria-hidden="true"
                                                    [popover]="popTemplate" containerClass="sidebarPopover"
                                                    placement="right" triggers="hover" container="body"></i>
                                            </div>
                                            <ng-template #popTemplate>
                                                <ul class="searchPopoverList" style="padding: 5px; margin: 0px;">
                                                    <li style="margin-bottom: 10px;">
                                                        <span>
                                                            Spaces between words work as
                                                            <b>AND</b>: a search for nodes with a field containing all
                                                            the typed
                                                            keywords will be performed.
                                                            <br /> e.g.: "foo bar" &#8594; it looks for fields
                                                            containing both
                                                            'foo'
                                                            <b>AND</b> 'bar'
                                                        </span>
                                                    </li>
                                                    <li>
                                                        <span>
                                                            To look for nodes with a field containing at least a keyword
                                                            you can use
                                                            <b>OR</b> between the keywords (type 'OR' uppercase).
                                                            <br /> e.g.: "foo OR bar" &#8594; it looks for fields
                                                            containing 'foo'
                                                            <b>OR</b> 'bar'
                                                        </span>
                                                    </li>
                                                </ul>
                                            </ng-template>
                                        </div>
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-12 btn-group">
                                                <button type="button" class="btn btn-primary form-control"
                                                    (click)="searchInCytoscape()">
                                                    <span>Search</span>
                                                    <i class="icon-arrow-right14 position-right"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </li>
                                    <li style="margin-top: 5%; padding-left: 5%;">
                                        <a (click)="graphSelectAll()" style="width: 50%; display: inline-block;">
                                            <i class="fa fa-minus-square-o"></i> Select all
                                        </a>
                                        <a (click)="graphUnselectAll()" style="width: 45%; display: inline-block;">
                                            <i class="fa fa-minus-square-o"></i> Unselect all
                                        </a>
                                    </li>
                                    <li style="padding-left: 5%;">
                                        <a (click)="graphSelectVerticesOnly()"
                                            style="width: 50%; display: inline-block;">
                                            <i class="fa fa-circle-o"></i> Vertices only
                                        </a>
                                        <a (click)="graphSelectEdgesOnly()" style="width: 45%; display: inline-block;">
                                            <i class="fa fa-minus"></i> Edges only
                                        </a>
                                    </li>
                                    <li style="padding-left: 5%;">
                                        <a (click)="graphSelectInverted()" style="width: 50%; display: inline-block;">
                                            <i class="fa fa-arrows-h"></i>Invert
                                        </a>
                                        <a (click)="graphSelectNotConnectedVertices()"
                                            style="width: 45%; display: inline-block;">
                                            <i class="fa fa-child"></i> Orphans
                                        </a>
                                    </li>
                                    <li>
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-11">
                                                <a (click)="graphSelectNeighbors('out')">
                                                    <i class="fa fa-toggle-right"></i> Outgoing Vertices Depth Level
                                                </a>
                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <i class="fa fa-question-circle command" aria-hidden="true"
                                                    [popover]="outgoingDepthTip" containerClass="sidebarPopover"
                                                    placement="right" triggers="hover" container="body"></i>
                                            </div>
                                        </div>
                                        <div class="noui-slider-info has-pips slider-container"
                                            id="graph_out_neighbors">
                                            <nouislider [config]="neighbourSliderConfig"
                                                [(ngModel)]="outNeighbourRange"></nouislider>
                                        </div>
                                        <ng-template #outgoingDepthTip>
                                            <span>
                                                Through this command you can select all the
                                                <b>Outgoing traversable edges and vertices
                                                    <br /> from a specific depth till another desired depth</b> by using
                                                the slider
                                                below.
                                                <br />
                                                <br /> Selecting for example outgoing vertices with
                                                <b>depth from 1 to 3</b> means selecting
                                                <br /> all the
                                                <b>neighbours of 1st, 2nd and 3th level</b>.
                                                <br />
                                                <br /> Thus this option has
                                                <b>nothing to do with the degree</b> (number of edges) of the current
                                                selected
                                                node,
                                                <br /> but rather it allows you to navigate all the reachable neighbours
                                                as a tree,
                                                and moreover select
                                                <br /> just the vertices contained in a relevant depth range.
                                            </span>
                                        </ng-template>
                                    </li>
                                    <li>
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-11">
                                                <a (click)="graphSelectNeighbors('in')">
                                                    <i class="fa fa-toggle-right"></i> Ingoing Vertices Depth Level
                                                </a>
                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <i class="fa fa-question-circle command" aria-hidden="true"
                                                    [popover]="ingoingDepthTip" containerClass="sidebarPopover"
                                                    placement="right" triggers="hover" container="body"></i>
                                            </div>
                                        </div>
                                        <div class="noui-slider-info has-pips slider-container" id="graph_in_neighbors">
                                            <nouislider [config]="neighbourSliderConfig" [(ngModel)]="inNeighbourRange">
                                            </nouislider>
                                        </div>
                                        <ng-template #ingoingDepthTip>
                                            <span>
                                                Through this command you can select all the
                                                <b>Ingoing traversable edges and vertices
                                                    <br /> from a specific depth till another desired depth</b> by using
                                                the slider
                                                below.
                                                <br />
                                                <br /> Selecting for example ingoing vertices with
                                                <b>depth from 1 to 3</b> means selecting
                                                <br /> all the
                                                <b>neighbours of 1st, 2nd and 3th level</b>.
                                                <br />
                                                <br /> Thus this option has
                                                <b>nothing to do with the degree</b> (number of edges) of the current
                                                selected
                                                node,
                                                <br /> but rather it allows you to navigate all the reachable neighbours
                                                as a tree,
                                                and moreover select
                                                <br /> just the vertices contained in a relevant depth range.
                                            </span>
                                        </ng-template>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <a>
                                    <i class="fa fa-columns fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '16.27px'}"></i>
                                    <span>Table</span>
                                </a>
                                <ul>
                                    <li *ngIf="tableInputElementsCardinality">
                                        <a>No data loaded yet.</a>
                                    </li>
                                    <li *ngIf="tableInputElementsCardinality">
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-6">
                                                <label for="dedicatedTableTabRadioOption">Dedicated Tab</label>
                                                <input id="dedicatedTableTabRadioOption" type="radio" [value]="true"
                                                    [(ngModel)]="tableTabEnabled"
                                                    (ngModelChange)="handleTablePerspectiveSwitch()">
                                            </div>
                                            <div class="col-md-6">
                                                <label for="bottomTableTabRadioOption">Bottom</label>
                                                <input id="bottomTableTabRadioOption" type="radio" [value]="false"
                                                    [(ngModel)]="tableTabEnabled"
                                                    (ngModelChange)="handleTablePerspectiveSwitch()">
                                            </div>
                                        </div>
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-7">
                                                <label>
                                                    'Class Name' column:
                                                </label>
                                            </div>
                                            <div class="col-md-4">
                                                <ui-switch [(ngModel)]="classNameColumnIncluded" size="small">
                                                </ui-switch>
                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <i class="fa fa-question-circle command" aria-hidden="true"
                                                    [popover]="popTemplate" containerClass="sidebarPopover"
                                                    placement="right" triggers="hover" container="body"></i>
                                            </div>
                                            <ng-template #popTemplate>
                                                <span>
                                                    Use this flag to show or hide the 'Class Name' column.
                                                </span>
                                            </ng-template>
                                        </div>
                                        <accordion [closeOthers]="true">
                                            <accordion-group class="classAccordion"
                                                *ngFor="let className of tableInputClassNames" [heading]="className"
                                                [panelClass]="outerAccordion" style="border-color: white;">
                                                <div class="clearfix">
                                                    <div class="row" style="padding: 5px 1px 10px 5px;">
                                                        <div class="col-lg-6"
                                                            (click)="selectAllPropertiesOfClass(className)">
                                                            <button type="button" class="btn btn-primary btn-xs">Select
                                                                All</button>
                                                        </div>
                                                        <div class="col-lg-6"
                                                            (click)="deselectAllPropertiesOfClass(className)">
                                                            <button type="button"
                                                                class="btn btn-primary btn-xs">Deselect All</button>
                                                        </div>
                                                    </div>
                                                    <ul>
                                                        <li *ngFor="let property of tableInputColumns">
                                                            <div
                                                                *ngIf="!property['name'].startsWith('@') && property['className'] === className">
                                                                <input type="checkbox"
                                                                    [(ngModel)]="property['included']"
                                                                    (ngModelChange)="makeColumnsChangeDetected()">
                                                                <span>{{property['name']}}</span>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </accordion-group>
                                        </accordion>
                                    </li>
                                </ul>
                            </li>
                            <li id="algorithmsMenu">
                                <a>
                                    <i class="fa fa-tachometer fa-2x"></i>
                                    <span>Algorithms</span>
                                </a>
                                <ul>
                                    <li style="margin-top: 5%; padding-left: 5%;">
                                        <div class="row">
                                            <div class="col-md-11">
                                                <a (click)="graphExecuteAlgorithm('shortest-path')">
                                                    <i class="fa fa-toggle-right"></i> Shortest Path
                                                </a>
                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <span (click)="openShortestPathConfigModal()">
                                                    <i class="fa fa-cog inner-menu-icon"
                                                        style="float: right; margin-right: 5px;"></i>
                                                </span>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label for="shortestPathFrom">From</label>
                                                    </div>
                                                    <div class="col-md-9"
                                                        (focusout)="cleanShortestPathNodesSelection($event)">
                                                        <input id="shortestPathFrom" class="form-control"
                                                            style="height: 25px;"
                                                            [(ngModel)]="shortestPathSourceNodeInputLabel"
                                                            (mousedown)="updateShortestPathNodesSelection('from', $event)"
                                                            readonly></input>
                                                        <span id="shortestPathFromClear" class="fa fa-times-circle-o"
                                                            (mousedown)="cleanShortestPathInput('from')"
                                                            title="Clear"></span>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2">
                                                        <label for="shortestPathTo">To</label>
                                                    </div>
                                                    <div class="col-md-9"
                                                        (focusout)="cleanShortestPathNodesSelection($event)">
                                                        <input id="shortestPathTo" class="form-control"
                                                            style="height: 25px;"
                                                            [(ngModel)]="shortestPathTargetNodeInputLabel"
                                                            (mousedown)="updateShortestPathNodesSelection('to', $event)"
                                                            readonly></input>
                                                        <span id="shortestPathToClear" class="fa fa-times-circle-o"
                                                            (mousedown)="cleanShortestPathInput('to')"
                                                            title="Clear"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <i *ngIf="(!shortestPathSourceNodeInputLabel || !shortestPathTargetNodeInputLabel) ||
                                                            (shortestPathTargetNodeInputLabel==='Select a node in the Graph' || shortestPathTargetNodeInputLabel==='Select a node in the Graph')"
                                                class="fa fa-arrows-v disabled" aria-hidden="true" id="shortestPathSwap"
                                                title="Swap" disabled></i>
                                            <i *ngIf="!((!shortestPathSourceNodeInputLabel || !shortestPathTargetNodeInputLabel) ||
                                                            (shortestPathTargetNodeInputLabel==='Select a node in the Graph' || shortestPathTargetNodeInputLabel==='Select a node in the Graph'))"
                                                class="fa fa-arrows-v" aria-hidden="true" id="shortestPathSwap"
                                                title="Swap" (click)="swapShortestPathInputVertices()"></i>
                                        </div>
                                    </li>
                                    <li style="margin-top: 3%; padding-left: 5%;">
                                        <div class="row">
                                            <div class="col-md-11">
                                                <a (click)="graphExecuteAlgorithm('pageRank')">
                                                    <i class="fa fa-toggle-right"></i> Page Rank
                                                </a>
                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <span (click)="openPageRankConfigModal()">
                                                    <i class="fa fa-cog inner-menu-icon"
                                                        style="float: right; margin-right: 5px;"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </li>
                                    <li style="margin-top: 5%; padding-left: 5%;">
                                        <div class="row">
                                            <div class="col-md-11">
                                                <a (click)="graphExecuteAlgorithm('centrality')">
                                                    <i class="fa fa-toggle-right"></i> Centrality
                                                </a>
                                            </div>
                                            <div class="col-md-1" style="padding-left: 2px;">
                                                <span (click)="openCentralityConfigModal()">
                                                    <i class="fa fa-cog inner-menu-icon"
                                                        style="float: right; margin-right: 5px;"></i>
                                                </span>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li id="timelineMenu">
                                <a (click)="prepareTimelineClasses()">
                                    <i class="fa fa-clock-o fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '18.72px'}"></i>
                                    <span>Timeline</span>
                                </a>
                                <ul>
                                    <li>
                                        <div class="row" style="padding: 5px 1px 0px 5px;">
                                            <div class="col-md-12">
                                                <div class="row">
                                                    <div class="col-lg-5">
                                                        <label for="timelineClassType">Class Type</label>
                                                        <select id="timelineClassType" class="form-control"
                                                            [(ngModel)]="newTimelineInputClassType"
                                                            (ngModelChange)="prepareTimelineClasses()">
                                                            <option value="node"> node </option>
                                                            <option value="edge"> edge </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-5">
                                                        <label for="timelineClassSelect">Class</label>
                                                        <select id="timelineClassSelect" class="form-control"
                                                            [(ngModel)]="newTimelineInputClass"
                                                            (ngModelChange)="updateTimelineClassProperties()">
                                                            <option *ngFor="let class of timelineChoosableClassesNames"
                                                                [ngValue]="class"> {{class}} </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-5">
                                                        <label for="timelinePropertySelect">Date Property</label>
                                                        <select id="timelinePropertySelect" class="form-control"
                                                            [(ngModel)]="newTimelineInputProperty">
                                                            <option
                                                                *ngFor="let property of (timelineClassProperties | objectKeys)"
                                                                [ngValue]="timelineClassProperties[property].name"
                                                                [disabled]="timelineClassProperties[property].type !== 'DATE' && timelineClassProperties[property].type !== 'DATETIME'
                                                                     && timelineClassProperties[property].type !== 'STRING'">
                                                                {{timelineClassProperties[property].name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                    <div class="col-lg-2">
                                                        <span *ngIf="newTimelineInputClass && newTimelineInputProperty"
                                                            class="addTimelineClassDef fa fa-plus fa-2x addTimelineClassDefEnabled"
                                                            (click)="addNewTimelineClass()"></span>
                                                        <span
                                                            *ngIf="!newTimelineInputClass || !newTimelineInputProperty"
                                                            class="addTimelineClassDef fa fa-plus fa-2x addTimelineClassDefDisabled"></span>
                                                    </div>
                                                </div>
                                                <br />
                                                <div class="row">
                                                    <div class="table-responsive">
                                                        <table class="table timeline-table">
                                                            <thead>
                                                                <tr>
                                                                    <th *ngFor="let column of tableColumns"
                                                                        [ngStyle]="{'width': column['width']}">
                                                                        {{column['text']}}
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr
                                                                    *ngFor="let class of (className2timelineDateInfo | objectKeys)">
                                                                    <td *ngFor="let column of tableColumns">
                                                                        <div *ngIf="column['text'] === 'Class'"
                                                                            [popover]="class" placement="top"
                                                                            triggers="hover" container="body">
                                                                            {{class}}
                                                                        </div>
                                                                        <div *ngIf="column['text'] === 'Date Property'"
                                                                            [popover]="className2timelineDateInfo[class]['property']"
                                                                            placement="top" triggers="hover"
                                                                            container="body">
                                                                            {{className2timelineDateInfo[class]['property']}}
                                                                        </div>
                                                                        <div *ngIf="column['text'] === ''"
                                                                            class="td-button btn-group flex-btn-group-container">
                                                                            <button class="btn btn-danger btn-xs"
                                                                                (click)="removeTimelineClass(class)">
                                                                                <span class="fa fa-remove"></span>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                        <br />
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <label>
                                                            Show Timeline:
                                                        </label>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <ui-switch [(ngModel)]="activateTimeline"
                                                            (ngModelChange)="handleTimelineSwitch()" size="small">
                                                        </ui-switch>
                                                    </div>
                                                </div>
                                                <div class="row" style="margin-bottom: 7px;">
                                                    <div class="col-lg-7">
                                                        <label for="timelineClassSelect">Start Date</label>
                                                        <input id="timelineStartDate" class="form-control ctrl-command"
                                                            type="date" title="Start Date"
                                                            [(ngModel)]="timelineStartDate" useValueAsDate
                                                            style="height: 25px;">
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-7">
                                                        <label for="timelinePropertySelect">End Date</label>
                                                        <input id="timelineEndDate" class="form-control ctrl-command"
                                                            type="date" title="End Date" [(ngModel)]="timelineEndDate"
                                                            useValueAsDate style="height: 25px;">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li id="layoutMenu">
                                <a>
                                    <i class="fa fa-universal-access fa-2x"></i>
                                    <span>Layout</span>
                                </a>
                                <ul>
                                    <li>
                                        <div class="row" style="padding: 10px 1px 0px 5px;">
                                            <div class="col-md-10">
                                                <!--<label class="form-control-label" for="layout">Layout</label>-->
                                                <select class="form-control" [(ngModel)]="lastLayoutName" id="layout"
                                                    (change)="applyLastLayout()">
                                                    <option value="force">Force</option>
                                                    <option value="breadthfirstCircle">Circle Breadthfirst</option>
                                                    <option value="breadthfirstTree">TopDown Breadthfirst</option>
                                                    <option value="cola">Cola</option>
                                                    <option value="dagre">Dagre</option>
                                                    <option value="spring">Spring</option>
                                                    <option value="dag">DAG</option>
                                                    <option value="concentric">Concentric</option>
                                                    <option value="circle">Circle</option>
                                                    <option value="grid">Grid</option>
                                                    <option value="random">Random</option>
                                                    <option value="preset">Preset</option>
                                                </select>
                                            </div>
                                            <div class="col-md-2" style="padding: 5px;">
                                                <i *ngIf="!currentRunningLayout" class="fa fa-2x fa-play command"
                                                    (click)="applyLastLayout()"></i>
                                                <i *ngIf="currentRunningLayout" class="fa fa-2x fa-pause command"
                                                    (click)="stopRunningLayout()"></i>
                                            </div>
                                        </div>
                                    </li>
                                    <br>
                                    <li>
                                        <div *ngIf="lastLayoutName !== 'force'" class="row graph-layout-settings">
                                            <div class="row" style="padding-top: 0px;">
                                                <div class="noui-slider-info has-pips slider-container"
                                                    id="graph_spacing">
                                                    <nouislider [config]="graphSpacingSliderConfig"
                                                        [(ngModel)]="graphSpacing" style="padding: 10px;"></nouislider>
                                                    <br>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <span style="padding: 10px;">Spacing factor:</span>
                                                </div>
                                                <div class="col-md-3">
                                                    <input id="graphSpacingInput" class="form-control" type="number"
                                                        style="width: 65px; height: 30px;" min="0.085" max="30"
                                                        step="0.1" [(ngModel)]="graphSpacing" />
                                                </div>
                                            </div>
                                        </div>
                                        <div *ngIf="lastLayoutName === 'force'" class="row graph-layout-settings"
                                            style="padding: 0px 1px 0px 5px;">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>
                                                        Spring Length:
                                                    </label>
                                                </div>
                                                <div class="col-md-5">
                                                    <input id="layoutTimeout"
                                                        class="form-control layout-input-params small-vertical-padding"
                                                        type="number" min="10" max="1000" step="1"
                                                        [(ngModel)]="springLength" />
                                                </div>
                                                <div class="col-md-1" style="padding-left: 2px;">
                                                    <i class="fa fa-question-circle command" aria-hidden="true"
                                                        [popover]="springLengthPopover" containerClass="sidebarPopover"
                                                        placement="right" triggers="hover" container="body"></i>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>
                                                        Spring Coefficient:
                                                    </label>
                                                </div>
                                                <div class="col-md-5">
                                                    <input id="layoutTimeout"
                                                        class="form-control layout-input-params small-vertical-padding"
                                                        type="number" step="0.0001" [(ngModel)]="springCoeff" />
                                                </div>
                                                <div class="col-md-1" style="padding-left: 2px;">
                                                    <i class="fa fa-question-circle command" aria-hidden="true"
                                                        [popover]="springCoeffPopover" containerClass="sidebarPopover"
                                                        placement="right" triggers="hover" container="body"></i>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>
                                                        Drag Coefficient:
                                                    </label>
                                                </div>
                                                <div class="col-md-5">
                                                    <input id="layoutTimeout"
                                                        class="form-control layout-input-params small-vertical-padding"
                                                        type="number" step="0.01" [(ngModel)]="dragCoeff" />
                                                </div>
                                                <div class="col-md-1" style="padding-left: 2px;">
                                                    <i class="fa fa-question-circle command" aria-hidden="true"
                                                        [popover]="dragCoeffPopover" containerClass="sidebarPopover"
                                                        placement="right" triggers="hover" container="body"></i>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>
                                                        Gravity Coefficient:
                                                    </label>
                                                </div>
                                                <div class="col-md-5">
                                                    <input id="layoutTimeout"
                                                        class="form-control layout-input-params small-vertical-padding"
                                                        type="number" step="0.1" [(ngModel)]="gravity" />
                                                </div>
                                                <div class="col-md-1" style="padding-left: 2px;">
                                                    <i class="fa fa-question-circle command" aria-hidden="true"
                                                        [popover]="gravityPopover" containerClass="sidebarPopover"
                                                        placement="right" triggers="hover" container="body"></i>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>
                                                        Theta:
                                                    </label>
                                                </div>
                                                <div class="col-md-5">
                                                    <input id="layoutTimeout"
                                                        class="form-control layout-input-params small-vertical-padding"
                                                        type="number" min="1" max="20" step="1" [(ngModel)]="theta" />
                                                </div>
                                                <div class="col-md-1" style="padding-left: 2px;">
                                                    <i class="fa fa-question-circle command" aria-hidden="true"
                                                        [popover]="thetaPopover" containerClass="sidebarPopover"
                                                        placement="right" triggers="hover" container="body"></i>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-7 btn-group">
                                                    <button type="button" class="btn btn-primary btn-xs form-control"
                                                        (click)="resetForceLayoutParamsToDefault()">
                                                        <span>Reset params to default</span>
                                                        <i class="icon-arrow-right14 position-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <br>
                                    <li>
                                        <div class="row" style="padding: 0px 1px 0px 5px;">
                                            <div class="col-md-6">
                                                <label>
                                                    Show Legend:
                                                </label>
                                            </div>
                                            <div class="col-md-6">
                                                <ui-switch [(ngModel)]="showLegend" size="small"
                                                    (ngModelChange)="checkLegendShowing()"></ui-switch>
                                            </div>
                                        </div>
                                        <div class="row" style="padding: 0px 1px 0px 5px;">
                                            <div class="col-md-6">
                                                <label>
                                                    Auto-layout:
                                                </label>
                                            </div>
                                            <div class="col-md-6">
                                                <ui-switch [(ngModel)]="autoLayout" size="small"></ui-switch>
                                            </div>
                                        </div>
                                        <div class="row" style="padding: 0px 1px 0px 5px;">
                                            <div class="col-md-6">
                                                <label>
                                                    Layout timeout:
                                                </label>
                                            </div>
                                            <div class="col-md-3">
                                                <input id="layoutTimeout" class="form-control small-vertical-padding"
                                                    type="number" style="width: 45px;height: 20px;" min="1" max="60"
                                                    step="1" [(ngModel)]="runningLayoutTimeThreshold" />
                                            </div>
                                            <div class="col-md-3" style="padding-left: 0px;">
                                                <span>secs</span>
                                            </div>
                                        </div>
                                        <div class="row" style="padding: 0px 1px 0px 5px;">
                                            <div class="col-md-6">
                                                <label>
                                                    Node Labels:
                                                </label>
                                                <br>
                                                <div class="col-md-2">
                                                    <ui-switch [(ngModel)]="showNodeLabels" size="small"
                                                        (change)="updateLabelVisibility('node')"></ui-switch>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <label>
                                                    Edge Labels:
                                                </label>
                                                <br>
                                                <div class="col-md-2">
                                                    <ui-switch [(ngModel)]="showEdgeLabels" size="small"
                                                        (change)="updateLabelVisibility('edge')"></ui-switch>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" style="padding: 0px 1px 0px 5px;">
                                            <div class="col-md-6">
                                                <label>
                                                    Node Degree:
                                                </label>
                                            </div>
                                            <div class="col-md-6">
                                                <ui-switch [(ngModel)]="nodesDegreeCanvasEnabled"
                                                    (ngModelChange)="updateNodesDegreeCanvasAccordingFlag()"
                                                    size="small"></ui-switch>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <li id="snapshotMenu">
                                <a>
                                    <i class="fa fa-camera fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '12.92px'}"></i>
                                    <span>Snapshot</span>
                                </a>
                                <ul>
                                    <snapshot-menu *ngIf="widget" #snapshotMenu [widgetId]="widget.id"
                                        (snapshotLoaded)="updateCytoscapeFromSnapshot($event)"
                                        (noSnapshotAvailable)="updateWidgetSnapshotFlag()"></snapshot-menu>
                                </ul>
                            </li>
                            <li id="exportMenu">
                                <a>
                                    <i class="fa fa-download fa-2x"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '16.84px'}"></i>
                                    <span>Export</span>
                                </a>
                                <ul>
                                    <li>
                                        <br />
                                        <div class="form-group">
                                            <label class="col-md-3 control-label">File Name</label>
                                            <div class="col-md-9">
                                                <input type="text" id="fileName" class="form-control"
                                                    [(ngModel)]="fileName" name="fileName"
                                                    placeholder="File name without extension" required />
                                            </div>
                                        </div>
                                    </li>
                                    <br>
                                    <br>
                                    <br>
                                    <li [ngClass]="{'li-disabled': !fileName}">
                                        <a *ngIf="cy" (click)="graphExport(cy.png(), 'image/png')"
                                            [ngClass]="{'link-disabled': !fileName}">
                                            Export as PNG
                                        </a>
                                        <a *ngIf="!cy" class="link-disabled">
                                            Export as PNG
                                        </a>
                                    </li>
                                    <li [ngClass]="{'li-disabled': !fileName}">
                                        <a *ngIf="cy" (click)="graphExport(cy.jpg(), 'image/jpeg')"
                                            [ngClass]="{'link-disabled': !fileName}">
                                            Export as JPEG
                                        </a>
                                        <a *ngIf="!cy" class="link-disabled">
                                            Export as JPEG
                                        </a>
                                    </li>
                                    <li [ngClass]="{'li-disabled': !fileName}">
                                        <a *ngIf="cy" (click)="graphExport(cy.json(), 'json')"
                                            [ngClass]="{'link-disabled': !fileName}">
                                            Export as JSON
                                        </a>
                                        <a *ngIf="!cy" class="link-disabled">
                                            Export as JSON
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li class="menu-separator">
                                <hr>
                            </li>
                            <li>
                                <a class="sidebar-control sidebar-main-toggle hidden-xs" (click)="toggleSideBar()">
                                    <i class="fa fa-desktop fa-2x position-left"
                                        [ngStyle]="!sidebarCollapsed && {'margin-right': '13.14px'}"></i>
                                    <span>Expand/Collapse</span>
                                </a>
                            </li>
                            <!-- /main -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>


        <!-- Main viewport -->
        <div [id]="'widget-viewport_' + widgetId" class="widget-table-cell widget-viewport">
            <tabset>
                <tab id="graphTab" heading="Graph" [active]="graphTabActive" (select)="switchTab('graph')">
                    <div [id]="'graph_viewport-container_' + widgetId" class="cell-content-wrapper panel panel-flat"
                        style="border-top: none; border-top-left-radius: 0px; border-top-right-radius: 0px;"
                        [ngClass]="{'no-border': minimizedView}">
                        <div class="position-relative" [id]="widgetId+'_config'"></div>
                        <div class="position-relative" [id]="widgetId"></div>

                        <!--Cytoscape Viewport-->
                        <div [id]="'cy_' + widgetId" class="viewport" [ngStyle]="{height: widgetHeight, width: '100%'}">
                            <i *ngIf="showSpinner" class="fa fa-spinner fa-pulse fa-3x fa-fw wait-spinner"
                                aria-hidden="true"></i>

                            <!--'Click To Edit' message-->
                            <div *ngIf="!snapshotLoaded && minimizedView && !embedded">
                                <a [routerLink]="['/widget', widget['id']]">
                                    <h2 class="empty-widget-message" [ngStyle]="{top: getEmptyWidgetMessageHeight()}">
                                        Click here to Edit the Widget</h2>
                                </a>
                            </div>
                        </div>

                        <!-- Legend -->
                        <div *ngIf="!minimizedView && dataSourceMetadata && showLegend" class='graph-legend movable'>
                            <div>
                                <span class='legend-title'>VERTICES</span> [ {{totalLoadedVertices}}/{{totalVertices}} ]
                                &nbsp;&nbsp;
                                <div *ngIf="!graphLegendCollapsedVertices" style="display: inline-block">
                                    <a *ngIf='graphLegendVerticesOrderedByCount' (click)='switchLegendVerticesOrder()'
                                        popover="Sort vertex classes by name" container="body" triggers="hover">
                                        <i class='fa fa-arrows-v'></i>
                                    </a>
                                    <a *ngIf='!graphLegendVerticesOrderedByCount' (click)='switchLegendVerticesOrder()'
                                        popover="Sort vertex classes by count" container="body" triggers="hover">
                                        <i class='fa fa-arrows-v'></i>
                                    </a>
                                </div>
                                <div *ngIf="graphLegendCollapsedVertices" style="display: inline-block">
                                    <i class='fa fa-arrows-v'></i>
                                </div>
                                &nbsp;
                                <a (click)='switchCollapseVertices()'>
                                    <i *ngIf='graphLegendCollapsedVertices' class='fa fa-plus'></i>
                                    <i *ngIf='!graphLegendCollapsedVertices' class='fa fa-minus'></i>
                                </a>
                                <div class='legend-scale' *ngIf='!graphLegendCollapsedVertices'>
                                    <ul class='legend-labels'>
                                        <ng-container *ngIf="!graphLegendVerticesOrderedByCount">
                                            <li
                                                *ngFor="let className of (dataSourceMetadata.nodesClasses | objectKeysByName)">
                                                <div [id]='"graph_vertexSelect_" + className'
                                                    class="graph_vertexSelect legend-label"
                                                    [ngStyle]="{'background': nodeClassesStyles.get(className).color}"
                                                    (click)='graphSelectElementsOfClass("node", className, "graph_vertexSelect_" + escapeSelector(className))'>
                                                    <div class="col-lg-7 legend-label-class-name" style="padding: 0px;">
                                                        <span class="mightOverflow">{{className}}</span>
                                                    </div>
                                                    <div class="col-lg-5" style="padding: 0px;">
                                                        <div class="pull-right">
                                                            <span>
                                                                <b>{{nodeClassesStyles.get(className).count}}/{{dataSourceMetadata.nodesClasses[className].cardinality}}</b>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </li>
                                        </ng-container>
                                        <ng-container *ngIf="graphLegendVerticesOrderedByCount">
                                            <li
                                                *ngFor="let className of (dataSourceMetadata.nodesClasses | objectKeysByCount: nodeClassesStyles)">
                                                <div [id]='"graph_vertexSelect_" + className'
                                                    class="graph_vertexSelect legend-label"
                                                    [ngStyle]="{'background': nodeClassesStyles.get(className).color}"
                                                    (click)='graphSelectElementsOfClass("node", className, "graph_vertexSelect_" + escapeSelector(className))'>
                                                    <div class="col-lg-7 legend-label-class-name" style="padding: 0px;">
                                                        <span class="mightOverflow">{{className}}</span>
                                                    </div>
                                                    <div class="col-lg-5" style="padding: 0px;">
                                                        <div class="pull-right">
                                                            <span>
                                                                <b>{{nodeClassesStyles.get(className).count}}/{{dataSourceMetadata.nodesClasses[className].cardinality}}</b>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </li>
                                        </ng-container>
                                    </ul>
                                </div>
                            </div>

                            <br>

                            <div>
                                <span class='legend-title'>EDGES</span> [ {{totalLoadedEdges}}/{{totalEdges}} ]
                                &nbsp;&nbsp;
                                <div *ngIf="!graphLegendCollapsedEdges" style="display: inline-block">
                                    <a *ngIf='graphLegendEdgesOrderedByCount' (click)='switchLegendEdgesOrder()'
                                        popover="Sort edge classes by name" container="body" triggers="hover">
                                        <i class='fa fa-arrows-v'></i>
                                    </a>
                                    <a *ngIf='!graphLegendEdgesOrderedByCount' (click)='switchLegendEdgesOrder()'
                                        popover="Sort edge classes by count" container="body" triggers="hover">
                                        <i class='fa fa-arrows-v'></i>
                                    </a>
                                </div>
                                <div *ngIf="graphLegendCollapsedEdges" style="display: inline-block">
                                    <i class='fa fa-arrows-v'></i>
                                </div>
                                &nbsp;
                                <a (click)='switchCollapseEdges()'>
                                    <i *ngIf='graphLegendCollapsedEdges' class='fa fa-plus'></i>
                                    <i *ngIf='!graphLegendCollapsedEdges' class='fa fa-minus'></i>
                                </a>
                                <div class='legend-scale' *ngIf='!graphLegendCollapsedEdges'>
                                    <ul class='legend-labels'>
                                        <ng-container *ngIf="!graphLegendEdgesOrderedByCount">
                                            <li
                                                *ngFor="let edgeClassName of (dataSourceMetadata.edgesClasses | objectKeysByName)">
                                                <div [id]='"graph_edgeSelect_" + edgeClassName'
                                                    class="graph_edgeSelect legend-label"
                                                    [ngStyle]="{'background': edgeClassesStyles.get(edgeClassName).color}"
                                                    (click)='graphSelectElementsOfClass("edge", edgeClassName, "graph_edgeSelect_" + escapeSelector(edgeClassName))'>
                                                    <div class="col-lg-7 legend-label-class-name" style="padding: 0px;">
                                                        <span class="mightOverflow">{{edgeClassName}}</span>
                                                    </div>
                                                    <div class="col-lg-5" style="padding: 0px;">
                                                        <div class="pull-right">
                                                            <span>
                                                                <b>{{edgeClassesStyles.get(edgeClassName).count}}/{{dataSourceMetadata.edgesClasses[edgeClassName].cardinality}}</b>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <br />
                                            </li>
                                        </ng-container>
                                        <ng-container *ngIf="graphLegendEdgesOrderedByCount">
                                            <li
                                                *ngFor="let edgeClassName of (dataSourceMetadata.edgesClasses | objectKeysByCount: edgeClassesStyles)">
                                                <div [id]='"graph_edgeSelect_" + edgeClassName'
                                                    class="graph_edgeSelect legend-label"
                                                    [ngStyle]="{'background': edgeClassesStyles.get(edgeClassName).color}"
                                                    (click)='graphSelectElementsOfClass("edge", edgeClassName, "graph_edgeSelect_" + escapeSelector(edgeClassName))'>
                                                    <div class="col-lg-7 legend-label-class-name" style="padding: 0px;">
                                                        <span class="mightOverflow">{{edgeClassName}}</span>
                                                    </div>
                                                    <div class="col-lg-5" style="padding: 0px;">
                                                        <div class="pull-right">
                                                            <span>
                                                                <b>{{edgeClassesStyles.get(edgeClassName).count}}/{{dataSourceMetadata.edgesClasses[edgeClassName].cardinality}}</b>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <br />
                                            </li>
                                        </ng-container>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </tab>
                <tab *ngIf="!minimizedView && tableTabEnabled" id="tableTab" heading="Table" [active]="tableTabActive"
                    (select)="switchTab('table')">
                    <div *ngIf="tableTabActive" [id]="'table_viewport-container_' + widgetId"
                        class="cell-content-wrapper panel panel-flat" [ngClass]="{'no-border': minimizedView}">

                        <!-- Table Viewport -->
                        <div [id]="'table_' + widgetId" class="viewport" [ngStyle]="{height: widgetHeight}">
                            <i *ngIf="showSpinner" class="fa fa-spinner fa-pulse fa-3x fa-fw wait-spinner"
                                aria-hidden="true"></i>

                            <table-data #tabTable
                                *ngIf="tableInputElementsCardinality > 0 && (tableInputColumns && tableInputColumns.length > 0)"
                                [tableContainerHeight]="widgetHeight" [inputColumns]="tableInputColumns"
                                [deletionEnabled]="true" [selectionEnabled]="true"
                                [classNameColumnIncluded]="classNameColumnIncluded"
                                [itemsPerPage]="activateTimeline ? 10 : 15"
                                (elementSelection)="selectElementOnTableAction($event)"
                                (elementUnselection)="unselectElementOnTableAction($event)"
                                (elementDeletion)="deleteElementOnTableAction($event)"
                                (inputDataChange)="callTableSelectionSort()">
                            </table-data>
                        </div>
                    </div>
                </tab>
                <tab *ngIf="dataSource && !minimizedView" id="datasourceTab" heading="Datasource"
                    [active]="datasourceTabActive" (select)="switchTab('datasource')">
                    <div *ngIf="datasourceTabActive" [id]="'datasource_viewport-container_' + widgetId"
                        class="cell-content-wrapper panel panel-flat"
                        style="border-top: none; border-top-left-radius: 0px; border-top-right-radius: 0px;"
                        [ngClass]="{'no-border': minimizedView}">

                        <!-- Datasource Viewport -->
                        <data-source-info [dataSource]="dataSource" [height]="startingWidgetHeight"
                            (datasourceIndexingCall)="callDatasourceIndexing()"></data-source-info>

                    </div>
                </tab>
            </tabset>

            <!-- Toolbar -->
            <div *ngIf="!minimizedView" id="upperToolBar" class="navbar navbar-default"
                [ngStyle]="{height: toolbarHeight}">

                <!-- Navbar header -->
                <div class="navbar-header">
                    <div class="row" style="padding: 5px 1px 0px 5px;">
                        <div class="col-md-12 btn-group">
                            <input id="fullTextSearchInput" type="search" class="form-control"
                                (keyup)="searchTerm.next($event.target.value)" placeholder="Type the text to search..."
                                (focus)="renderFullTextSearch()" (blur)="updateFullTextSearchRendering()">
                            <span id="fullTextSearchClear" class="fa fa-times-circle-o" (click)="resetFullTextSearch()"
                                title="Clear"></span>
                        </div>
                    </div>
                </div>

                <!-- Left nav -->
                <ul class="nav navbar-nav">
                    <li>
                        <a (click)="traverseAllFromSelectedNodes()">
                            <i class="fa fa-arrows-alt" title="Traverse All"></i>
                        </a>
                    </li>
                    <li dropdown>
                        <a dropdownToggle>
                            <i class="fa fa-plus" title="Add Element"></i>
                        </a>
                        <ul *dropdownMenu class="dropdown-menu dropdown-menu-right">
                            <li>
                                <a class="dropdown-item" (click)="openAddNodeModal()">
                                    <i class="fa fa-circle-o"></i>&nbsp;Add Node </a>
                            </li>
                            <li>
                                <a class="dropdown-item" (click)="executeAddEdgeCommand(false)">
                                    <i class="fa fa-long-arrow-right"></i>&nbsp;Add Edge </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a (click)="graphDeleteSelected('all')">
                            <i class="fa fa-trash" title="Delete"></i>
                        </a>
                    </li>
                    <li>
                        <a (click)="crop()">
                            <i class="fa fa-crop" title="Crop"></i>
                        </a>
                    </li>
                </ul>

                <!-- Right nav -->
                <ul class="nav navbar-nav navbar-right">
                    <li *ngIf="!activateTimeline">
                        <a (click)="toggleTimeline()">
                            <i class="fa fa-clock-o" title="Open Timeline"></i>
                        </a>
                    </li>
                    <li *ngIf="activateTimeline">
                        <a id="activateTimelineShortcut" (click)="toggleTimeline()">
                            <i class="fa fa-clock-o" title="Close Timeline"></i>
                        </a>
                    </li>
                    <li *ngIf="tableTabEnabled">
                        <a (click)="toggleTablePerspective()">
                            <i class="fa fa-window-restore" title="Bottom Table"></i>
                        </a>
                    </li>
                    <li *ngIf="!tableTabEnabled">
                        <a (click)="toggleTablePerspective()">
                            <i class="fa fa-columns" title="Tab Table"></i>
                        </a>
                    </li>
                    <li>
                        <a *jhiHasAnyAuthority="['ROLE_ADMIN', 'ROLE_EDITOR']" (click)="saveAll()">
                            <i class="fa fa-save" title="Save"></i>
                        </a>
                        <a *jhiHasAnyAuthority="'ROLE_READER'" class="disabled">
                            <i class="fa fa-save" title="Save"></i>
                        </a>
                    </li>
                </ul>
            </div>

            <!--Full Text Search-->
            <div *ngIf="renderFullTextSearchView" [id]="'fullTextSearch_' + widgetId" class='fulltext-search'
                [ngStyle]="{'max-height': widgetHeight, padding: '0px'}">
                <fulltext-search [datasourceId]="widget['dataSourceId']" [searchTerm]="searchTerm"
                    [componentHeight]="widgetHeight" (queryEmitter)="loadNodesFromIds($event)"
                    (noSuchIndexEmitter)="resetFullTextSearch(true)" (closeEmitter)="resetFullTextSearch(true)">
                </fulltext-search>
            </div>

            <div *ngIf="minimizedView" style="opacity: 0; height: 1px; font-size: 1px;">
                <!--Used to update the view when only width changes-->
                {{widgetColumnWidth}}
            </div>

            <!--Context Menu: Traverse SubMenu-->
            <div *ngIf="traverseSubmenuActivated" id="traverse-submenu"
                class="cy-context-menus-cxt-menu traverse-submenu"
                [ngStyle]="{display: 'block', 'border-style': 'none', 'border-color': 'lightgrey', left: traverseSubmenuLeft, top: traverseSubmenuTop}">
                <traverse-menu [nodes]="traverseSubmenuInputNodes"
                    (traverseRequestEmitter)="executeTraverseFromEvent($event)">
                </traverse-menu>
            </div>

            <!-- Timeline -->
            <div *ngIf="!minimizedView && activateTimeline && !datasourceTabActive" id="timeline-container"
                class="cell-content-wrapper">
                <timeline #timelineComponent [inputTimelineItems]="timelineInputItems"
                    [lowerBoundDate]="timelineStartDate" [upperBoundDate]="timelineEndDate"
                    [filteringWindowActive]="timelineFilteringWindowActive"
                    [firstBarTime]="timelineFilteringWindowStart" [secondBarTime]="timelineFilteringWindowEnd"
                    (filterEmitter)="filterElementsAccordingToTimeline($event)"
                    (disableTimeFilterEmitter)="resetTimelineFiltering()" (closeTimelineEmitter)="closeTimeline(100)"
                    (wrongClassConfigEmitter)="handleWrongClassTimelineConfig($event)"
                    (filteringWindowStateChanged)="updateTimelineFilteringWindowState($event)"></timeline>
            </div>

            <!-- Table -->
            <div *ngIf="!minimizedView && !tableTabEnabled && !datasourceTabActive" id="bottom-table-container"
                class="cell-content-wrapper">
                <div [id]="'bottom_table_' + widgetId" class="bottom_table_viewport"
                    [ngStyle]="{height: '245px', width: '100%'}">
                    <table-data #bottomTable
                        *ngIf="tableInputElementsCardinality > 0 && (tableInputColumns && tableInputColumns.length > 0)"
                        [inputColumns]="tableInputColumns" [deletionEnabled]="true" [selectionEnabled]="true"
                        [classNameColumnIncluded]="classNameColumnIncluded" [itemsPerPage]="5"
                        (elementSelection)="selectElementOnTableAction($event)"
                        (elementUnselection)="unselectElementOnTableAction($event)"
                        (elementDeletion)="deleteElementOnTableAction($event)"
                        (inputDataChange)="callTableSelectionSort()">
                    </table-data>
                </div>
            </div>
        </div>

    </div>
</div>